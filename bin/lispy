#!/usr/bin/env node

'use strict';

const fs = require('fs');

const Parser = require('../dist').Parser;
const Interpreter = require('../dist').Interprter;

function evalGlobal(src, interpreter) {
    const exp = Parser.parse(`(begin ${src})`);
    return interpreter.evalGlobal(exp);
}

function main(argv) {
    const [_node, path, mode, exp] = argv;

    const interpreter = new Interpreter();

    // String eval
    if (mode === '-e') {
        console.log(evalGlobal(exp, interpreter));
    }

    // Eval from file
    if (mode === '-f') {
        const src = fs.readFileSync(exp, 'utf-8');
        console.log(evalGlobal(src, interpreter));
    }
}

main(process.argv);